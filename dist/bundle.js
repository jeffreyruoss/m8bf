(()=>{"use strict";var __webpack_modules__={609:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Menu});class Menu{constructor(e){this.scene=e,this.enabled=!0,this.open=!1,this.box=null,this.currentPanelName="inventory",this.currentPanel=null,this.padding=30,this.navHeight=null,this.scene.menuItems=this.scene.add.group()}toggleMenu(){this.open?(this.scene.menuItems.children.each((e=>e.destroy())),this.box.destroy(),this.currentPanel=null,this.open=!1):(this.createMenu(),this.open=!0)}updateMenu(){this.scene.Menu.toggleMenu(),this.scene.Menu.toggleMenu()}createMenu(){this.createMenuRectangle(),this.nav();const panelName=this.currentPanelName.charAt(0).toUpperCase()+this.currentPanelName.slice(1);this.currentPanel=new(eval(panelName+"Panel"))(this.scene),this.currentPanel.createPanel(this),this.scene.menuItems.children.each((e=>{e.setDepth("Text"===e.type?5:4),e.setScrollFactor(0).setOrigin(0)}))}createMenuRectangle(){const e=this.scene.cameras.main.width/2-482,t=this.scene.cameras.main.height/2-445;this.scene.Menu.box=this.scene.add.rectangle(e,t,964,890,2236468),this.scene.menuItems.add(this.scene.Menu.box).setOrigin(1,0)}nav(){const e=this.scene.menuJSON,t={fontSize:"19px",fontFamily:this.scene.font,padding:15,backgroundColor:"#3f3f74"};let s=this.box.x,i=this.box.y,n=[],a=[];for(let o in e){const r=this.navItem(o,e[o],t,s,i);"system"!==e[o].type?n.push(r):a.push(r)}this.navHeight=n[0].height,n.forEach((e=>{e.setPosition(s,i),s+=e.width,s+=2})),a.reverse(),s=this.box.x+this.box.width,a.forEach((e=>{s-=e.width,e.setPosition(s,i),s-=2}))}navItem(e,t,s,i,n){const a=this.scene.add.text(i,n,t.name,s).setInteractive();return this.scene.Mouse.buttonHover(a),a.on("pointerdown",(()=>{this.currentPanelName=e,this.updateMenu()})),this.scene.menuItems.add(a),a}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{class e extends Phaser.Scene{constructor(){super("Intro")}init(){}preload(){this.load.audio("start","./../../sounds/sfx_coin_cluster5.mp3")}create(){this.cameras.main.fadeIn(1e3);const e=this.cameras.main.worldView.x+this.cameras.main.width/2,t=this.cameras.main.worldView.y+this.cameras.main.height/2;this.add.text(e,t-40,"This is the Intro screen",{fontFamily:"vcrosdmono",fontSize:"50px",fill:"#fff"}).setOrigin(.5),this.add.text(e,t+40,"Start new game",{fontFamily:"vcrosdmono",fontSize:"30px",fill:"#0f0"}).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.sound.add("start").play(),this.cameras.main.fadeOut(2e3),this.time.delayedCall(2e3,(()=>{this.scene.start("Main")}))})),this.add.text(e,t+120,"Load from last save",{fontFamily:"vcrosdmono",fontSize:"30px",fill:"#0f0"}).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.sound.add("start").play(),this.cameras.main.fadeOut(2e3),this.time.delayedCall(2e3,(()=>{this.scene.start("Main",{loadGame:!0})}))}));const s=localStorage.getItem("m8bf");if(s){const i=JSON.parse(s).time;this.add.text(e,t+160,i,{fontFamily:"vcrosdmono",fontSize:"22px",fill:"#0f0"}).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.cameras.main.fadeOut(1e3),this.time.delayedCall(1e3,(()=>{this.scene.start("Main",{loadGame:!0})}))}))}}update(){}}class t{constructor(e){this.scene=e}npcsBeforeDialog(e){const t=e.data.get("npcKey");if("markusTheGray"===t&&0===e.data.get("dialogNumber")&&this.scene.player.inventory.wood>=1&&this.scene.player.inventory.stone>=1&&(e.data.set("dialogNumber",1),e.data.set("dialogStatus","initial")),"markusTheGray"===t&&1===e.data.get("dialogNumber")&&this.scene.player.inventory.stoneAxe>=1&&(e.data.set("dialogNumber",2),e.data.set("dialogStatus","initial")),"markusTheGray"===t&&2===e.data.get("dialogNumber")&&this.scene.player.inventory.workbench>=1&&(e.data.set("dialogNumber",3),e.data.set("dialogStatus","initial")),"markusTheGray"===t&&3===e.data.get("dialogNumber")){let t=!1;this.scene.allObjects.children.iterate((e=>{"workbench"===e.name&&(t=!0)})),t&&(e.data.set("dialogNumber",4),e.data.set("dialogStatus","initial"))}}npcsAfterDialog(e){const t=e.data.get("npcKey");"markusTheGray"===t&&1===e.data.get("dialogNumber")&&"initial"===e.data.get("dialogStatus")&&(this.scene.InfoBar.createInfoBar(["Go to Craft in the menu to craft a Stone Ax."]),this.scene.time.delayedCall(1e4,(()=>{this.scene.InfoBar.destroyInfoBar()}))),"markusTheGray"===t&&3===e.data.get("dialogNumber")&&"initial"===e.data.get("dialogStatus")&&(this.scene.InfoBar.createInfoBar(["Go to Workbench in your inventory and place the workbench on the ground."]),this.scene.time.delayedCall(1e4,(()=>{this.scene.InfoBar.destroyInfoBar()})))}}class s extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player"),this.scene=e,this.x=t,this.y=s,this.playerEnabled=!1,this.createPlayer()}createPlayer(){this.scene.data.loadGame&&this.scene.savedGameData?(this.x=this.scene.savedGameData.player.x,this.y=this.scene.savedGameData.player.y):(this.x=this.scene.sceneWidth/2,this.y=this.scene.sceneHeight/2),this.scene.anims.createFromAseprite("player"),this.scene.physics.add.existing(this),this.scene.add.existing(this),this.setDepth(2),this.setSize(32,21),this.setOffset(19,31),this.setAlpha(0),this.name="player",this.scene.data.loadGame&&this.scene.savedGameData?(this.attributes=this.scene.savedGameData.player.attributes,this.inventory=this.scene.savedGameData.player.inventory):(this.inventory={wood:100,stone:20,ironOre:20,iron:0,crystal:0,stoneAxe:0,ironAxe:0,stonePickaxe:0,ironPickaxe:0,chest:1,workbench:1,workshop:0,furnace:1,natureShrine:0,ironMine:0,crystalMine:0,automaton:1},this.attributes={movementSpeed:300,collectionSpeed:{tree:300,juvenileTree:300,sapling:300,stoneFormation:300,ironOreDeposit:300,crystalDeposit:300}},this.scene.allObjects.add(this))}}class i{constructor(e){this.scene=e,this.player=this.scene.player,this.player.direction="down"}playerMove(){this.player.setVelocity(0),this.scene.keys.A.isDown&&this.scene.keys.W.isDown?(this.player.setVelocityX(-this.player.attributes.movementSpeed),this.player.setVelocityY(-this.player.attributes.movementSpeed),this.player.direction="left",this.player.anims.play("Walk left",!0)):this.scene.keys.A.isDown&&this.scene.keys.S.isDown?(this.player.setVelocityX(-this.player.attributes.movementSpeed),this.player.setVelocityY(this.player.attributes.movementSpeed),this.player.anims.play("Walk left",!0),this.player.direction="left"):this.scene.keys.D.isDown&&this.scene.keys.W.isDown?(this.player.setVelocityX(this.player.attributes.movementSpeed),this.player.setVelocityY(-this.player.attributes.movementSpeed),this.player.anims.play("Walk right",!0),this.player.direction="right"):this.scene.keys.D.isDown&&this.scene.keys.S.isDown?(this.player.setVelocityX(this.player.attributes.movementSpeed),this.player.setVelocityY(this.player.attributes.movementSpeed),this.player.anims.play("Walk right",!0),this.player.direction="right"):this.scene.keys.A.isDown?(this.player.setVelocityX(-this.player.attributes.movementSpeed),this.player.play("Walk left",!0),this.player.direction="left"):this.scene.keys.D.isDown?(this.player.setVelocityX(this.player.attributes.movementSpeed),this.player.play("Walk right",!0),this.player.direction="right"):this.scene.keys.W.isDown?(this.player.setVelocityY(-this.player.attributes.movementSpeed),this.player.play("Walk up",!0),this.player.direction="up"):this.scene.keys.S.isDown?(this.player.setVelocityY(this.player.attributes.movementSpeed),this.player.play("Walk down",!0),this.player.direction="down"):this.playerIdle()}playerIdle(){"left"===this.player.direction?this.player.play("Idle left",!0):"right"===this.player.direction?this.player.play("Idle right",!0):"up"===this.player.direction?this.player.play("Idle up",!0):"down"===this.player.direction&&this.player.play("Idle down",!0)}}class n{constructor(e){this.scene=e,this.dialogueActive=!1,this.dialogueStep=0,this.dialogueLength=0}dialog(){const e=this.checkForNpc();if(e){this.scene.StoryLogic.npcsBeforeDialog(e);const t=e.data.get("npcKey"),s=e.data.get("npcName"),i=e.data.get("dialogNumber"),n=e.data.get("dialogStatus"),a=this.scene.dialogJSON[t].dialog[i][n];!1===this.dialogueActive?this.startDialog(a,s):this.dialogueStep+1<this.dialogueLength?this.continueDialog(a):this.finishDialog(n,e)}}checkForNpc(){let e=!1;return this.scene.allObjects.children.iterate((t=>{if("player"===t.name)return;const s=this.scene.player.getBounds(),i=t.getBounds();Phaser.Geom.Intersects.RectangleToRectangle(s,i)&&"npc"===t.name&&(e=t)})),e}startDialog(e,t){this.dialogueActive=!0,this.dialogueLength=Object.keys(e).length,this.scene.player.enabled=!1;const s=this.scene.cameras.main.width-60,i=this.scene.cameras.main.worldView.x+30,n=this.scene.cameras.main.worldView.y+this.scene.cameras.main.height-150-80;this.dialogBox=this.scene.add.rectangle(i,n,s,150,16777215,1),this.dialogBox.setOrigin(0),this.dialogBox.setDepth(5);let a={fontFamily:this.scene.font,fontSize:22,fill:"#386483"};this.dialogNpcName=this.scene.add.text(i+15,n+15,t,a),this.dialogNpcName.setDepth(5),this.dialogNpcName.line=this.scene.add.line(i+15,n+50,0,0,this.dialogNpcName.width+50,0,3695747,1),this.dialogNpcName.line.setDepth(5),this.dialogNpcName.line.alpha=.3,this.dialogNpcName.line.setOrigin(0),a={fontFamily:this.scene.font,fontSize:24,fill:"#000000"},this.dialogText=this.scene.add.text(i+15,n+65,e[this.dialogueStep],a),this.dialogText.setDepth(5)}continueDialog(e){this.dialogueStep+=1,this.dialogText.setText(e[this.dialogueStep])}finishDialog(e,t){this.dialogueActive=!1,this.dialogueStep=0,this.scene.player.enabled=!0,this.dialogBox.destroy(),this.dialogNpcName.destroy(),this.dialogNpcName.line.destroy(),this.dialogText.destroy(),"initial"===e&&(this.scene.StoryLogic.npcsAfterDialog(t),t.data.set("dialogStatus","return"))}}class a{constructor(e){this.scene=e,this.collectTime=0}collect(){this.scene.allObjects.children.iterate((e=>{if(void 0===e)return;const t=this.scene.mapObjectsJSON[e.name];if(void 0!==t&&void 0!==t.harvestType&&this.scene.time.now>this.collectTime){const s=this.scene.player.getBounds(),i=e.getBounds();if(Phaser.Geom.Intersects.RectangleToRectangle(s,i)){let s=this.scene.player.attributes.collectionSpeed[e.name];if(!this.mapObjectHasRequirements(e,t,s))return;if(!this.playerHasRequirements(e,t,s))return;"tree"===t.harvestType?this.harvestTree(e,t):"mine"===t.harvestType&&this.harvestMine(e,t),this.collectTime=this.scene.time.now+s}}}))}mapObjectHasRequirements(e,t,s){if(void 0!==t.objectRequires){const i=t.objectRequires;for(const[t,n]of Object.entries(i))if(e.data.get(t)<n.amount)return this.scene.MessageManager.createMessage(e.x,e.y,n.message,"info"),this.collectTime=this.scene.time.now+s,!1}return!0}playerHasRequirements(e,t,s){if(void 0!==t.playerRequires){const i=t.playerRequires.items,n=this.scene.player.inventory;let a=!1;for(const[e,t]of Object.entries(i))n[e]>=t.amount&&(a=!0);if(!a)return this.scene.MessageManager.createMessage(e.x,e.y,t.playerRequires.message,"info"),this.collectTime=this.scene.time.now+s,!1}return!0}harvestTree(e,t){e.data.set("harvestTicks",e.data.get("harvestTicks")+1),e.data.get("harvestTicks")>=t.totalHarvestTicks&&(this.scene.sound.play("treeFall"),this.scene.player.inventory.wood+=e.data.get("wood"),this.scene.MessageManager.createMessage(e.x,e.y,`+${e.data.get("wood")} Wood`,"positive"),e.destroy()),this.scene.sound.play("treeChop")}harvestMine(e,t){e.data.set("harvestTicks",e.data.get("harvestTicks")+1),e.data.get("harvestTicks")>=t.totalHarvestTicks&&(e.data.set(t.resource.key,e.data.get(t.resource.key)-1),this.scene.player.inventory[t.resource.key]+=1,e.data.get(t.resource.key)<=0?(this.scene.sound.play("ironMineDeplete"),this.scene.player.inventory[t.resource.key]+=1,e.destroy(),this.scene.MessageManager.createMessage(e.x,e.y,`+1 ${t.resource.name}`,"positive"),this.scene.time.delayedCall(300,(()=>{this.scene.MessageManager.createMessage(e.x,e.y,`${t.name} is depleted`,"info")}))):(this.scene.sound.play("ironMineCollect"),e.data.set("harvestTicks",0),this.scene.MessageManager.createMessage(e.x,e.y,`+1 ${t.resource.name}`,"positive"))),this.scene.sound.play("ironMinePick")}}class o{constructor(e){this.scene=e}pickUp(){this.scene.allObjects.children.iterate((e=>{if((!e||"player"!==e.name)&&e){const t=this.scene.player.getBounds(),s=e.getBounds();if(Phaser.Geom.Intersects.RectangleToRectangle(t,s)&&void 0!==this.scene.mapObjectsJSON[e.name]&&this.scene.mapObjectsJSON[e.name].pickUp){this.scene.sound.play("pickUp"),this.scene.player.inventory[e.name]+=1;const t=`+1 ${this.scene.mapObjectsJSON[e.name].name}`;this.scene.MessageManager.createMessage(e.x,e.y,t,"positive"),e.destroy()}}}))}}class r{constructor(e){this.scene=e}static init(e,t,s,i,n,a){this.scene=e,this.smeltMenuItems=s.actionMenuItems;const o=t.data.list.wood>0,r=t.data.list.ironOre>0,c=t.data.list.iron>0,h=this.scene.player.inventory.wood>0,l=this.scene.player.inventory.ironOre>0,d=this.scene.add.text(i,n,"Add wood",a);this.smeltMenuItems.add(d),!h||c?d.setAlpha(.5):(this.scene.Mouse.buttonHover(d),d.setInteractive(),d.on("pointerdown",(()=>{this.scene.player.inventory.wood-=1,t.data.list.wood+=1,s.refreshActionMenu(t)}),this)),n+=70;const p=this.scene.add.text(i,n,"Add Iron Ore",a);this.smeltMenuItems.add(p),!l||c?p.setAlpha(.5):(this.scene.Mouse.buttonHover(p),p.setInteractive(),p.on("pointerdown",(()=>{this.scene.player.inventory.ironOre-=1,t.data.list.ironOre+=1,s.refreshActionMenu(t)}),this)),n+=70;const u=this.scene.add.text(i,n,"Take Iron",a);this.smeltMenuItems.add(u),c?(this.scene.Mouse.buttonHover(u),u.setInteractive(),u.on("pointerdown",(()=>{this.scene.player.inventory.iron+=1,t.data.list.iron-=1,this.scene.sound.play("ironMineCollect"),s.refreshActionMenu(t)}),this)):u.setAlpha(.5),n+=70;let g=0;if(o){const e=this.scene.add.image(i,n,"wood").setOrigin(0,0);this.smeltMenuItems.add(e)}if(r){g=o?70:0;const e=this.scene.add.image(i+g,n,"ironOre").setOrigin(0,0);this.smeltMenuItems.add(e)}if(c){g=o?70:0,g+=r?70:0;const e=this.scene.add.image(i+g,n,"iron").setOrigin(0,0);this.smeltMenuItems.add(e);const t=this.scene.add.text(i,n+65,"Smelting Complete",{fontSize:"21px",fontFamily:this.scene.font});this.smeltMenuItems.add(t)}if(n+=70,o&&r){const e=this.scene.add.text(i,n,"Smelting in progress",{color:"#fbf236",fontSize:"24px",fontFamily:this.scene.font});this.smeltMenuItems.add(e);const t=this.scene.Smelt.smeltingTime/1e3,s=this.scene.add.text(i,n+30,`Smelting takes ${t} seconds`,{color:"#ffffff",fontSize:"20px",fontFamily:this.scene.font});this.smeltMenuItems.add(s)}}}class c{constructor(e){this.scene=e}static init(e,t,s,i,n,a){this.scene=e,this.automatonMenuItems=s.actionMenuItems;const o=this.scene.add.text(i,n,"Pick up Automaton",a);this.automatonMenuItems.add(o),o.setInteractive(),this.scene.Mouse.buttonHover(o),o.on("pointerdown",(()=>{t.destroy(),this.scene.player.inventory.automaton+=1,s.actionMenuClose(),this.scene.MessageManager.createMessage(this.scene.pointer.worldX,this.scene.pointer.worldY,"Automaton added to your inventory","positive")}));const r=this.scene.add.text(i,n+60,"Assign task",a);this.automatonMenuItems.add(r),r.setInteractive(),this.scene.Mouse.buttonHover(r),r.on("pointerdown",(()=>{s.actionMenuClose(),t.assignTask(t)}));const c=t.getData("assignedTaskTarget");if(c){const t=e.mapObjectsJSON[c.name].name,s={fontSize:"19px",fontFamily:this.scene.font},a=this.scene.add.text(i,n+120,`Assigned task: ${t}`,s);this.automatonMenuItems.add(a)}}}class h{constructor(e){this.scene=e,this.actionMenuOpen=!1,this.actionMenuItems=this.scene.add.group(),this.currentObject=null,this.actionMenuCloseListener()}init(){this.actionMenuOpen?this.actionMenuClose():(this.scene.automatons.children.iterate((e=>{const t=this.scene.player.getBounds(),s=e.getBounds();Phaser.Geom.Intersects.RectangleToRectangle(t,s)&&(this.currentObject=e)})),this.scene.furnaces.children.iterate((e=>{const t=this.scene.player.getBounds(),s=e.getBounds();Phaser.Geom.Intersects.RectangleToRectangle(t,s)&&(this.currentObject=e)})),this.currentObject&&(this.scene.player.enabled=!1,this.actionMenuOpen=!0,this.openActionMenu()))}actionMenuCloseListener(){this.scene.input.keyboard.on("keydown",(e=>{"Escape"===e.key&&this.actionMenuOpen&&this.actionMenuClose()}))}actionMenuClose(){this.currentObject=null,this.actionMenuOpen=!1,this.actionMenuItems.children.each((e=>e.destroy())),this.scene.player.enabled=!0}refreshActionMenu(e){this.actionMenuClose(),this.actionMenuOpen=!0,this.openActionMenu(e)}openActionMenu(){let e=this.scene.cameras.main.worldView.x+this.scene.cameras.main.width/2,t=this.scene.cameras.main.worldView.y+this.scene.cameras.main.height/2;const s=this.scene.add.rectangle(e,t,500,500,2236468);this.actionMenuItems.add(s);const i=s.getBounds();e=i.x+15,t=i.y+15;const n={fontSize:"19px",fontFamily:this.scene.font,padding:15,backgroundColor:"#3f3f74"},a=this.scene.add.text(e+i.width-30,t,"Close",n);a.setOrigin(1,0),this.actionMenuItems.add(a),this.scene.Mouse.buttonHover(a),a.setInteractive(),a.on("pointerdown",(()=>{this.actionMenuClose()}),this),"automaton"===this.currentObject.name?c.init(this.scene,this.currentObject,this,e,t,n):"furnace"===this.currentObject.name&&r.init(this.scene,this.currentObject,this,e,t,n),this.actionMenuItems.children.iterate((e=>e.setDepth(5)))}}class l{constructor(e){this.scene=e}inspect(){this.scene.keys.I.on("down",(()=>{const e=this.scene.player.getBounds(),t=new Phaser.Geom.Rectangle(e.x,e.y,e.width,e.height);"up"===this.scene.player.direction&&(t.y-=16),"down"===this.scene.player.direction&&(t.y+=16),"left"===this.scene.player.direction&&(t.x-=16),"right"===this.scene.player.direction&&(t.x+=16),this.scene.allObjects.children.iterate((e=>{if("player"===e.name)return;const s=e.getBounds();Phaser.Geom.Intersects.RectangleToRectangle(t,s)&&(console.log("---------------------"),console.log("this object's name:",e.name),console.log(e.data?e.data.list:"object.data is null"),console.log("This object's full object: ",e),console.log("---------------------"))}))}))}}class d{constructor(e){this.scene=e,this.Dialog=new n(e),this.Collect=new a(e),this.PickUp=new o(e),this.ActionMenu=new h(e),this.Inspect=new l(e)}dialog(){this.Dialog.dialog()}collect(){this.Collect.collect()}pickUp(){this.PickUp.pickUp()}actionMenu(){this.ActionMenu.init()}inspect(){this.Inspect.inspect()}}class p extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,n,a,o){super(e,t,s,"boundary"),this.setDepth(2),this.setAlpha(0),this.scene.physics.add.existing(this),this.body.setSize(i,n),this.body.setOffset(a,o),this.body.immovable=!0,e.add.existing(this),this.scene.physics.add.collider(this,this.scene.player)}}class u extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,n){super(e,t,s,"npc"),this.play({key:"Idle down - npc",repeat:-1}),this.setDepth(2),e.physics.add.existing(this),e.add.existing(this),this.name="npc",this.body.setSize(35,25),this.body.setOffset(17,28),e.allObjects.add(this),e.physics.add.collider(this,e.allObjects),this.body.immovable=!0,this.setDataEnabled(),this.data.set("npcKey",i),this.data.set("npcName",n),this.data.set("dialogNumber",0),this.data.set("dialogStatus","initial"),new p(this.scene,t,s,40,65,0,-10),e.npcs.add(this)}}class g extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"automaton"),this.automatonIsMoving=!1,this.setDepth(2),e.physics.add.existing(this),e.add.existing(this),this.name="automaton",this.body.setSize(35,28),this.body.setOffset(16,28),this.setOrigin(0,0),this.play({key:"Idle down - automaton",repeat:-1}),e.allObjects.add(this),e.physics.add.collider(this,e.allObjects),this.body.immovable=!0,this.boundary=new p(this.scene,t,s,35,69,33,22),this.on("destroy",(()=>{this.boundary.destroy()})),e.automatons.add(this),e.physics.add.collider(this,e.allObjects,(()=>{this.body.stop(),this.boundary.body.stop(),e.AutomatonMovement.setIdleAnimation(this)}))}assignTask(){this.scene.InfoBar.createInfoBar(["Select an object to assign the Automaton to.","Press ESC to cancel."]),this.scene.Selection.getObject((e=>{let t="";"cancel"!==e?(this.setData("assignedTaskTarget",e),t=`Automaton assigned to ${this.scene.mapObjectsJSON[e.name].name}`):t="Automaton task canceled",this.scene.MessageManager.createMessage(this.x,this.y,t,"info"),this.scene.InfoBar.destroyInfoBar()}))}}class m{constructor(e){this.scene=e}generateGrass(){const e=this.scene.cameras.main.width*this.scene.sceneSizeMultiplier,t=this.scene.cameras.main.height*this.scene.sceneSizeMultiplier;this.scene.grass=this.scene.add.tileSprite(0,0,e,t,"grass").setOrigin(0)}scrollGrass(){const e=this.scene.cameras.main.scrollX,t=this.scene.cameras.main.scrollY;this.scene.grass.x=-1e-4*e,this.scene.grass.y=-1e-4*t}generateObjects(e,t,s=0){const i=this.scene.textures.get(e).getSourceImage().width,n=this.scene.textures.get(e).getSourceImage().height;this.scene[t]=this.scene.physics.add.staticGroup();const a=this.scene.player.x,o=this.scene.player.y;if(this.scene.data.loadGame&&this.scene.savedGameData)this.scene.savedGameData.structures.forEach((s=>{s.name===e&&this.generateObject(e,t,s.x,s.y,i,n,s.data)}));else{const r=this.scene.mapObjectsJSON[e];for(let s=0;s<this.scene.sceneWidth;s+=i)for(let c=0;c<this.scene.sceneHeight;c+=n)if(Math.random()<r.frequency){if(s<a+50&&s>a-50&&c<o+50&&c>o-50)continue;const h=s+Math.floor(Math.random()*i)-i/2,l=c+Math.floor(Math.random()*n)-n/2;this.generateObject(e,t,h,l,i,n,r)}this.scene[t].getChildren().length<s&&this.generateObjects(e,t,s)}}generateObject(e,t,s,i,n,a,o){const r=this.scene.physics.add.staticSprite(s,i,e).setOrigin(0,0).setAlpha(1).setSize(64,32).setOffset(32,64);r.name=e,r.setDataEnabled();let c=o.data?o.data:o;Object.entries(c).forEach((([e,t])=>{r.data.set(e,t)})),"ironMine"!==e&&"crystalMine"!==e&&this.scene.physics.overlap(r,this.scene.allObjects)?r.destroy():(this.scene.mapObjectsJSON[e].flat||(r.setAlpha(0),r.images=[this.scene.add.image(s,i,e).setOrigin(0,0).setDepth(3).setCrop(0,0,n,a/2),this.scene.add.image(s,i,e).setOrigin(0,0).setDepth(1).setCrop(0,a/2,n,a/2)],r.on("destroy",(()=>r.images.forEach((e=>e.destroy()))))),this.scene.mapObjectsJSON[e].traversable||this.scene.physics.add.collider(this.scene.player,r),this.scene[t]||(this.scene[t]=this.scene.physics.add.staticGroup()),this.scene[t].add(r),this.scene.allObjects.add(r))}generateNPCs(){this.scene.data.loadGame&&this.scene.savedGameData?(this.scene.savedGameData.npcs.forEach((e=>{new u(this.scene,e.x,e.y,e.data)})),this.scene.savedGameData.automatons.forEach((e=>{new g(this.scene,e.x,e.y,e.data)}))):(new u(this.scene,this.scene.sceneWidth/2-100,this.scene.sceneHeight/2-100,"markusTheGray","Markus the Gray"),new g(this.scene,this.scene.sceneWidth/2+100,this.scene.sceneHeight/2+100))}}var y=__webpack_require__(609);class f{constructor(e){this.scene=e}craftItem(e,t){let s=this.scene.player.inventory,i=t.recipe;if(this.isEnoughResources(t)){for(let e in i)s[e]-=i[e];s[e]+=1,this.scene.sound.play("craft"),this.scene.Menu.updateMenu()}}isEnoughResources(e){let t=this.scene.player.inventory,s=e.recipe,i=!0;for(let e in s)(t[e]<s[e]||void 0===t[e])&&(i=!1);return i}hasRequiredMapObject(e){if(void 0===e.requiredMapObject)return!0;let t=e.requiredMapObject,s=!1;return this.scene.allObjects.children.iterate((e=>{e.name===t&&(s=!0)})),s}}class M{constructor(e,t,s,i,n){this.scene=e,this.text=t,this.x=s,this.y=i,this.type=n,this.style=this.style(),this.message=this.add(),this.textColor()}style(){return{fontFamily:this.scene.font,fontSize:"20px",backgroundColor:"rgba(203,219,252,0.9)",padding:5}}textColor(){"positive"===this.type?this.message.setColor("#37946e"):"negative"===this.type?this.message.setColor("#AE3737"):"info"===this.type&&this.message.setColor("#2B6180")}add(){return this.scene.add.text(this.x,this.y,this.text,this.style).setDepth(6)}}class b{constructor(e){this.scene=e,this.messages=[]}createMessage(e,t,s,i){const n=new M(this.scene,s,e,t,i);this.floatUpMessage(n),this.floatUpPreviousMessage(e,t),this.messages.push(n),this.scene.time.delayedCall(1700,(()=>this.fadeOutMessage(n))),this.scene.time.delayedCall(2e3,(()=>this.destroyMessage(n)))}floatUpMessage(e){this.scene.tweens.add({targets:e.message,y:e.message.y-30,duration:300})}floatUpPreviousMessage(e,t){this.messages.length>0&&this.messages.forEach((s=>{s.x===e&&s.y===t&&(s.message.y-=15,this.scene.tweens.add({targets:s.message,y:s.message.y-30,duration:300}))}))}fadeOutMessage(e){this.scene.tweens.add({targets:e.message,alpha:0,duration:300})}destroyMessage(e){e.message.destroy(),e=null}}class w{constructor(e){this.scene=e,this.prePlaceStructure=null,this.key=null,this.pointer=null}placeHandler(){this.scene.input.on("pointerdown",(()=>{this.prePlaceStructure&&this.placeConditions()}))}cancelHandler(){this.scene.input.keyboard.on("keydown-ESC",(()=>{this.prePlaceStructure&&(this.destroyPrePlace(),this.scene.Menu.enabled=!0)}))}placeConditions(){const e=this.checkForObstruction();"ironMine"===this.key&&"ironOreDeposit"!==e.name?(this.scene.MessageManager.createMessage(this.pointer.worldX,this.pointer.worldY,"Must be placed on iron ore deposit","negative"),this.scene.sound.play("error")):"crystalMine"===this.key&&"crystalDeposit"!==e.name?(this.scene.MessageManager.createMessage(this.pointer.worldX,this.pointer.worldY,"Must be placed on crystal deposit","negative"),this.scene.sound.play("error")):"ironMine"===this.key&&"ironOreDeposit"===e.name?(e.data.set("mine",1),this.place(),this.destroyPrePlace()):"crystalMine"===this.key&&"crystalDeposit"===e.name?(e.data.set("crystalMine",1),this.place(),this.destroyPrePlace()):e?(this.scene.MessageManager.createMessage(this.pointer.worldX,this.pointer.worldY,"Too close to another thing","negative"),this.scene.sound.play("error")):(this.place(),this.destroyPrePlace())}checkForObstruction(){let e=!1;return this.scene.allObjects.children.iterate((t=>{Phaser.Geom.Intersects.RectangleToRectangle(this.prePlaceStructure.getBounds(),t.getBounds())&&(e=t)})),e}placeInit(e){this.scene.Menu.enabled=!1,this.pointer=this.scene.input.activePointer,this.key=e,this.prePlace()}prePlace(){this.prePlaceStructure=this.scene.physics.add.image(this.pointer.worldX,this.pointer.worldY,this.key).setAlpha(.7).setTint(10616651).setOrigin(0).setDepth(4),this.scene.InfoBar.createInfoBar(["Press ESC to cancel","Hold SHIFT to snap to grid"])}destroyPrePlace(){this.prePlaceStructure&&(this.prePlaceStructure.destroy(),this.prePlaceStructure=null,this.scene.InfoBar.destroyInfoBar())}place(){const e=this.scene.textures.get(this.key).getSourceImage().width,t=this.scene.textures.get(this.key).getSourceImage().height,s=this.scene.mapObjectsJSON[this.key];"automaton"===this.key?new g(this.scene,this.prePlaceStructure.x,this.prePlaceStructure.y):this.scene.MapGenerator.generateObject(this.key,s.groupName,this.prePlaceStructure.x,this.prePlaceStructure.y,e,t,s),this.scene.sound.play("placeStructure"),this.scene.player.inventory[this.key]-=1,this.key=null,this.pointer=null,this.scene.Menu.enabled=!0}update(){this.scene.Place.prePlaceStructure&&(this.scene.input.keyboard.checkDown(this.scene.keys.SHIFT)?(this.scene.Place.prePlaceStructure.x=64*Math.floor(this.scene.pointer.worldX/64),this.scene.Place.prePlaceStructure.y=64*Math.floor(this.scene.pointer.worldY/64)):(this.scene.Place.prePlaceStructure.x=this.scene.pointer.worldX-this.scene.Place.prePlaceStructure.width/2,this.scene.Place.prePlaceStructure.y=this.scene.pointer.worldY-this.scene.Place.prePlaceStructure.height/2))}}class S{constructor(e){this.scene=e,this.rectangle=null,this.texts=[]}createInfoBar(e){this.rectangle=this.scene.add.rectangle(0,-50,this.scene.sceneWidth,50,"0xdf7126").setAlpha(.9).setScrollFactor(0).setOrigin(0).setDepth(4);let t=15;"string"==typeof e&&(e=[e]),e.forEach(((e,s)=>{let i={fontSize:"19px",fontFamily:this.scene.font,color:"#ffffff"};const n=this.scene.add.text(t,-35,e,i).setOrigin(0).setScrollFactor(0).setDepth(4);t+=n.width+50,this.texts.push(n)})),this.scene.tweens.add({targets:this.rectangle,y:0,duration:500,ease:"Power2"}),this.scene.tweens.add({targets:[...this.texts],y:15,duration:500,ease:"Power2"})}destroyInfoBar(){this.scene.tweens.add({targets:this.rectangle,y:-50,duration:500,ease:"Power2"}),this.scene.tweens.add({targets:[...this.texts],y:-35,duration:500,ease:"Power2"}),this.scene.time.delayedCall(500,(()=>{this.rectangle.destroy(),this.texts.forEach((e=>e.destroy()))}))}}class x{constructor(e){this.scene=e,this.margin=15,this.tweenDuration=500,this.infoBoxes=this.scene.add.group()}reApplyXPositions(){this.infoBoxes.getChildren().forEach(((e,t)=>{const s=t*e.displayWidth+(t+1)*this.margin;this.scene.tweens.add({targets:e,x:s,duration:this.tweenDuration,ease:"Power2"})}))}}class O{constructor(e,t){this.scene=e,this.message=t,this.createInfoBox()}createInfoBox(){const e=this.scene.InfoBoxManager.infoBoxes.getChildren().length,t=this.scene.InfoBoxManager.margin,s=200*e+(e+1)*t,i=this.scene.add.text(s,0,this.message,{fontSize:"18px",fontFamily:this.scene.font,color:"#000000",backgroundColor:"#e8e4a4",padding:{x:15,y:15}}).setDepth(4).setOrigin(0,1).setScrollFactor(0).setWordWrapWidth(200).setInteractive();i.displayWidth=200,this.scene.tweens.add({targets:i,y:i.displayHeight+t,duration:this.scene.InfoBoxManager.tweenDuration,ease:"Power2"}),this.scene.InfoBoxManager.infoBoxes.add(i),i.on("pointerdown",(()=>{this.scene.InfoBoxManager.infoBoxes.remove(i),this.scene.InfoBoxManager.reApplyXPositions(),i.destroy()}),this)}}class v{constructor(e){this.scene=e}buttonHover(e){e.on("pointerover",(()=>{this.scene.input.setDefaultCursor("pointer"),"Text"===e.type?e.setStyle({backgroundColor:"#5f5f94"}):"Rectangle"===e.type&&e.setFillStyle(6250388)})),e.on("pointerout",(()=>{this.scene.input.setDefaultCursor("default"),"Text"===e.type?e.setStyle({backgroundColor:"#3f3f74"}):"Rectangle"===e.type&&e.setFillStyle(4145012)})),e.on("destroy",(()=>this.scene.input.setDefaultCursor("default")))}}class k{constructor(e){this.scene=e}clickToMove(e){this.scene.input.on("pointerdown",(t=>{const s=t.worldX,i=t.worldY;this.scene.allObjects.children.iterate((t=>{const n=t.getBounds();if(s>n.x&&s<n.x+n.width&&i>n.y&&i<n.y+n.height){const t=n.x+n.width/2,s=n.y+n.height/2;e.automatonIsMoving=!0,this.setWalkAnimation(e,t,s),this.scene.physics.moveTo(e,t,s,300),this.scene.physics.moveTo(e.boundary,t,s,300)}}))}))}setWalkAnimation(e,t,s){const i=Phaser.Math.Angle.Between(e.x,e.y,t,s),n=Phaser.Math.RadToDeg(i),a=n<0?360+n:n;e.direction=a>=0&&a<45?"right":a>=45&&a<135?"down":a>=135&&a<225?"left":a>=225&&a<315?"up":a>=315&&a<=360?"right":"down",e.play({key:`Walk ${e.direction} - automaton`,repeat:-1})}setIdleAnimation(e){e.automatonIsMoving&&(e.play({key:`Idle ${e.direction} - automaton`,repeat:-1}),e.automatonIsMoving=!1)}}class P{constructor(e){this.scene=e,this.timer=1e3,this.secondsBetweenGrowth=10,this.shrineBonusMultiplier=2,this.counter=0,this.saplingWidth=this.scene.textures.get("sapling").getSourceImage().width,this.saplingHeight=this.scene.textures.get("sapling").getSourceImage().height,this.juvenileTreeWidth=this.scene.textures.get("juvenileTree").getSourceImage().width,this.juvenileTreeHeight=this.scene.textures.get("juvenileTree").getSourceImage().height,this.treeWidth=this.scene.textures.get("tree").getSourceImage().width,this.treeHeight=this.scene.textures.get("tree").getSourceImage().height}update(){this.scene.time.now>this.timer&&(this.counter>9&&this.counter%this.secondsBetweenGrowth==0&&(this.scene.allObjects.children.iterate((e=>{e&&"sapling"===e.name?this.scene.time.delayedCall(1,(()=>{this.growToJuvenileTree(e)})):e&&"juvenileTree"===e.name?this.scene.time.delayedCall(1,(()=>{this.growToTree(e),this.growToJuvenileTree(e)})):e&&"natureShrine"===e.name&&this.scene.time.delayedCall(1,(()=>{this.createShrineSaplings(e)}))})),this.createSaplings()),this.counter+=1,this.timer=this.scene.time.now+1e3)}growToTree(e){e.destroy(),this.scene.MapGenerator.generateObject("tree","trees",e.x,e.y,this.treeWidth,this.treeHeight,this.scene.mapObjectsJSON.tree,!0)}growToJuvenileTree(e){e.destroy(),this.scene.MapGenerator.generateObject("juvenileTree","juvenileTrees",e.x,e.y,this.juvenileTreeWidth,this.juvenileTreeHeight,this.scene.mapObjectsJSON.juvenileTree,!0)}createShrineSaplings(e){const t=100;for(let s=0;s<5;s++){const s=Phaser.Math.Between(e.x-t,e.x+t),i=Phaser.Math.Between(e.y-t,e.y+t);this.scene.MapGenerator.generateObject("sapling","saplings",s,i,this.saplingWidth,this.saplingHeight,this.scene.mapObjectsJSON.sapling,!0)}}createSaplings(){for(let e=0;e<1;e++){const e=Phaser.Math.Between(0,this.scene.sceneWidth),t=Phaser.Math.Between(0,this.scene.sceneHeight);this.scene.MapGenerator.generateObject("sapling","saplings",e,t,this.saplingWidth,this.saplingHeight,this.scene.mapObjectsJSON.sapling,!0)}}}class j{constructor(e){this.scene=e,this.timer=0,this.smeltingTime=1e4}update(){this.timer<60?this.timer+=1:(this.timer=0,this.scene.furnaces.children.iterate((e=>{e.data.list.wood>0&&e.data.list.ironOre>0&&!e.data.list.smelting?(e.data.list.smelting=!0,e.data.list.smeltStartTime=this.scene.time.now):e.data.list.smelting&&e.data.list.smeltStartTime+this.smeltingTime<this.scene.time.now&&(e.data.list.wood-=1,e.data.list.ironOre-=1,e.data.list.iron+=1,e.data.list.smelting=!1,e.data.list.smeltStartTime=0,this.scene.PlayerActions.ActionMenu.actionMenuOpen&&this.scene.PlayerActions.ActionMenu.refreshActionMenu(this.scene.PlayerActions.ActionMenu.currentObject))})))}}class I{constructor(e){this.scene=e,this.selectionModeEnabled=!1,this.callBack=null,this.onScreenObjects=[]}getObject(e){this.selectionModeEnabled||(this.callBack=e,this.enterSelectionMode())}getOnScreenObjects(){this.scene.allObjects.children.iterate((e=>{if(this.scene.cameras.main.worldView.contains(e.x,e.y)){const t=this.scene.mapObjectsJSON[e.name];if(void 0===t)return;if(void 0===t.actionableByAutomaton)return;this.onScreenObjects.push(e)}}))}enterSelectionMode(){this.scene.player.enabled=!1,this.selectionModeEnabled=!0,this.getOnScreenObjects(),this.cancelListener(),this.onScreenObjects.forEach((e=>{e.setAlpha(1),e.setInteractive(),e.on("pointerover",(()=>this.setTint(e))),e.on("pointerout",(()=>this.clearTint(e))),e.on("pointerdown",(()=>{this.clearTint(e),this.callBack(e),this.exitSelectionMode()}))}))}setTint(e){e.images?e.images.forEach((e=>{e.setTint(65280)})):e.setTint(65280)}clearTint(e){e.images?e.images.forEach((e=>{e.clearTint()})):e.clearTint()}cancelListener(){this.scene.input.keyboard.on("keydown",(e=>{"Escape"===e.key&&(null!==this.callBack&&this.callBack("cancel"),this.exitSelectionMode())}))}exitSelectionMode(){this.onScreenObjects.forEach((e=>{e.disableInteractive(),e.off("pointerover"),e.off("pointerout"),e.off("pointerdown"),e.images||e.setAlpha(0)})),this.selectionModeEnabled=!1,this.scene.player.enabled=!0,this.onScreenObjects=[],this.callBack=null,this.scene.input.keyboard.off("keydown")}}class _{constructor(e,t="top-left"){this.scene=e,this.element=this.create(t)}create(e){const t={fontFamily:this.scene.font,fontSize:19,color:"#9AE061",backgroundColor:"rgba(0,0,0,0.7)",padding:7};this.fpsText=this.scene.add.text(0,0,"FPS: 00.00",t).setDepth(1e3).setScrollFactor(0);const s=this.fpsText.width,i=this.fpsText.height,n=this.scene.cameras.main.width,a=this.scene.cameras.main.height;let o="top-left"===e||"bottom-left"===e?10:n-s-10,r="top-left"===e||"top-right"===e?10:a-i-10;return this.fpsText.setPosition(o,r),this.fpsText}update(){const e=this.scene.game.loop.actualFps;this.fpsText.setText("FPS: "+Math.round(100*e)/100)}}class T extends Phaser.Scene{constructor(){super("Main"),this.font="earls-revenge",this.sceneSizeMultiplier=2,this.loopPaused=!1,document.scene=this}preload(){this.add.text(this.sys.game.config.width/2,this.sys.game.config.height/2,"Generating world...",{fontFamily:this.font,fontSize:32}).setOrigin(.5),this.load.aseprite("player","./../../img/player.png","./../../img/player.json"),this.load.aseprite("automaton","./../../img/automaton-wood.png","./../../img/automaton.json"),this.load.aseprite("npc","./../../img/npc.png","./../../img/npc.json"),this.load.image("grass","./../../img/grass.png"),this.load.image("tree","./../../img/tree.png"),this.load.image("juvenileTree","./../../img/juvenile-tree.png"),this.load.image("sapling","./../../img/sapling.png"),this.load.image("ironOreDeposit","./../../img/iron-ore-deposit.png"),this.load.image("ironMine","./../../img/iron-mine.png"),this.load.image("crystalMine","./../../img/crystal-mine.png"),this.load.image("stoneFormation","./../../img/stone-formation.png"),this.load.image("crystalDeposit","./../../img/crystal-deposit.png"),this.load.image("chest","./../../img/chest.png"),this.load.image("workbench","./../../img/workbench.png"),this.load.image("workshop","./../../img/workshop.png"),this.load.image("advancedWorkshop","./../../img/advanced-workshop.png"),this.load.image("furnace","./../../img/furnace.png"),this.load.image("natureShrine","./../../img/nature-shrine.png"),this.load.image("stoneAxe","./../../img/stone-axe.png"),this.load.image("ironAxe","./../../img/iron-axe.png"),this.load.image("stonePickaxe","./../../img/stone-pickaxe.png"),this.load.image("ironPickaxe","./../../img/iron-pickaxe.png"),this.load.image("wood","./../../img/wood.png"),this.load.image("stone","./../../img/stone.png"),this.load.image("ironOre","./../../img/iron-ore.png"),this.load.image("iron","./../../img/iron.png"),this.load.image("crystal","./../../img/crystal.png"),this.load.audio("music","./../../sounds/painful-memories-compressed.mp3"),this.load.audio("portal","./../../sounds/sfx_movement_portal1.mp3"),this.load.audio("treeChop","./../../sounds/sfx_sounds_impact6.mp3"),this.load.audio("treeFall","./../../sounds/sfx_sounds_impact11.mp3"),this.load.audio("ironMinePick","./../../sounds/sfx_sounds_button3.mp3"),this.load.audio("ironMineCollect","./../../sounds/sfx_coin_double4.mp3"),this.load.audio("ironMineDeplete","./../../sounds/sfx_sounds_impact11.mp3"),this.load.audio("placeStructure","./../../sounds/sfx_wpn_punch3.mp3"),this.load.audio("craft","./../../sounds/sfx_coin_cluster3.mp3"),this.load.audio("error","./../../sounds/sfx_sounds_error4.mp3"),this.load.audio("pickUp","./../../sounds/sfx_movement_ladder2a.mp3"),this.load.json("menuJSON","./../../js/menu/menu.json"),this.load.json("itemsJSON","./../../js/items.json"),this.load.json("mapObjectsJSON","./../../js/map-objects.json"),this.load.json("dialogJSON","./../../js/dialog.json")}create(e){this.data=e,this.savedGameData=e.loadGame?JSON.parse(localStorage.getItem("m8bf")):null,this.time.advancedTiming=!0,this.pointer=this.input.activePointer,this.menuJSON=this.cache.json.get("menuJSON"),this.itemsJSON=this.cache.json.get("itemsJSON"),this.mapObjectsJSON=this.cache.json.get("mapObjectsJSON"),this.dialogJSON=this.cache.json.get("dialogJSON"),this.StoryLogic=new t(this),this.allObjects=this.add.group(),this.sceneWidth=this.sys.game.config.width*this.sceneSizeMultiplier,this.sceneHeight=this.sys.game.config.height*this.sceneSizeMultiplier,this.MapGenerator=new m(this),this.MapGenerator.generateGrass(),this.player=new s(this,this.sceneWidth/2,this.sceneHeight/2),this.cameras.main.setBounds(0,0,this.sceneWidth,this.sceneHeight),this.physics.world.setBounds(0,0,this.sceneWidth,this.sceneHeight),this.player.setCollideWorldBounds("true"),this.cameras.main.startFollow(this.player,!0,.1,.1),this.InfoBar=new S(this),this.keys=this.input.keyboard.addKeys("W,A,S,D,SPACE,C,B,I,P,R,ESC,SHIFT"),this.Mouse=new v(this),this.PlayerMovement=new i(this),this.PlayerActions=new d(this),this.PlayerActions.inspect(),this.Craft=new f(this),this.MessageManager=new b(this),this.Selection=new I(this),this.Place=new w(this),this.Place.placeHandler(),this.Place.cancelHandler(),this.Menu=new y.Z(this),this.keys.C.on("down",(()=>!this.Menu.enabled||this.Menu.toggleMenu(this.Menu.currentPanel))),this.keys.ESC.on("down",(()=>!this.Menu.open||this.Menu.toggleMenu(this.Menu.currentPanel))),this.cameras.main.fadeIn(2e3),this.MapGenerator.generateObjects("ironOreDeposit","ironOreDeposits",this.sceneSizeMultiplier),this.MapGenerator.generateObjects("stoneFormation","stoneFormations",this.sceneSizeMultiplier),this.MapGenerator.generateObjects("tree","trees",2*this.sceneSizeMultiplier),this.MapGenerator.generateObjects("sapling","saplings"),this.MapGenerator.generateObjects("juvenileTree","juvenileTrees"),this.MapGenerator.generateObjects("crystalDeposit","crystalDeposits",this.sceneSizeMultiplier),this.MapGenerator.generateObjects("workshop","workshops"),this.MapGenerator.generateObjects("ironMine","ironMines"),this.MapGenerator.generateObjects("chest","chests"),this.MapGenerator.generateObjects("stone","stone",this.sceneSizeMultiplier),this.MapGenerator.generateObjects("wood","wood",this.sceneSizeMultiplier),this.MapGenerator.generateObjects("workbench","workbenches"),this.MapGenerator.generateObjects("furnace","furnaces"),this.MapGenerator.generateObjects("natureShrine","natureShrines"),this.MapGenerator.generateObjects("crystalMine","crystalMines"),this.TreeGrowth=new P(this),this.Smelt=new j(this),this.anims.createFromAseprite("npc"),this.npcs=this.add.group(),this.anims.createFromAseprite("automaton"),this.automatons=this.add.group(),this.AutomatonMovement=new k(this),this.MapGenerator.generateNPCs("npc","npcs"),e.loadGame,this.player.setAlpha(1),this.player.enabled=!0,this.keys.SPACE.on("down",(()=>{this.PlayerActions.dialog(),this.PlayerActions.pickUp(),this.PlayerActions.actionMenu()})),this.keys.P.on("down",(()=>this.loopPaused=!this.loopPaused)),this.keys.R.on("down",(()=>this.scene.restart())),this.FPS=new _(this,"bottom-left"),this.MapGenerator.generateObject("furnace","furnaces",this.sceneWidth/2+100,this.sceneHeight/2,64,64,this.mapObjectsJSON.furnace),this.InfoBoxManager=new x(this),new O(this,"Hints will appear in these boxes. Click anywhere on these hint boxes to close them."),new O(this,'Use the "W", "A", "S", and "D" keys to move. Use the "SPACE" key to interact with a person or object.')}update(){this.loopPaused||(this.MapGenerator.scrollGrass(),this.player.enabled?(this.PlayerMovement.playerMove(),this.input.keyboard.checkDown(this.keys.SPACE)&&this.PlayerActions.collect()):this.PlayerMovement.playerIdle(),this.Place.update(),this.TreeGrowth.update(),this.Smelt.update(),this.FPS.update())}}const D={type:Phaser.WEBGL,width:1024,height:960,maxWidth:1024,maxHeight:960,pixelArt:!0,scene:[T,e],scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},title:"M8BF",physics:{default:"arcade",arcade:{}}},A=new Phaser.Game(D);document.game=A})()})();